import hgsysinc
from hgstat_test_movie import (
    hgstat_print_ratings_dict,
    hgstat_print_ratings_dict_summary,
)
from hgstat_test_movielens import hgstat_ratings_dict__movlens
#---------------------------
# {영화}를 기준으로 {사용자, 평점} 목록으로 읽는다.
#---------------------------
UserBase=False # False: {영화}를 기준으로 {사용자, 평점} 목록으로 처리
movie_ratings_dict, userIdList, movieIdList = \
    hgstat_ratings_dict__movlens(UserBase=UserBase)
#---------------
# movie_ratings_dict format: {'movieId': [(userId, rating_value), (),...]}
#---------------
# {
# 31: [(1, 2.5), (7, 3.0), (31, 4.0), (32, 4.0), ...,],
# 1029: [(1, 3.0), (19, 5.0), (35, 1.5), (61, 2.5), ...,],
# 1061: [(1, 3.0), (19, 3.0), (23, 3.5), (30, 3.0), ...,],
# }
#---------------

#---------------
#---------------
print(f'userIdList: {len(userIdList)}')
print(f'movieIdList: {len(movieIdList)}')

# 맨 앞에서 10개 출력
prt_begin = 0
prt_num = 10
hgstat_print_ratings_dict(movie_ratings_dict, 
    prt_begin=prt_begin, prt_num=prt_num, UserBase=UserBase)

#---------------------------
# 통계를 요약
#---------------------------
ratings_lists, ratings_count_lists, stat_max, stat_min, stat_avg \
    = hgstat_print_ratings_dict_summary(movie_ratings_dict)

'''
처리 결과:
================================
userIdList: 610
movieIdList: 9724


ratings_dict: 9724
index   영화ID  영화수  영화 평점 목록(고객ID, 평점)
0       1       215     [(1, 4.0), (5, 4.0), (7, 4.5), (15, 2.5), (17, 4.5), (18, 3.5), (19, 4.0), (21, 3.5), (27, 3.0), (31, 5.0), (32, 3.0), (33, 3.0), (40, 5.0), (43, 5.0), (44, 3.0), (45, 4.0), (46, 5.0), (50, 3.0), (54, 3.0), (57, 5.0), (63, 5.0), (64, 4.0), (66, 4.0), (68, 2.5), (71, 5.0), (73, 4.5), (76, 0.5), (78, 4.0), (82, 2.5), (86, 4.0), (89, 3.0), (90, 3.0), (91, 4.0), (93, 3.0), (96, 5.0), (98, 4.5), (103, 4.0), (107, 4.0), (112, 3.0), (119, 3.5), (121, 4.0), (124, 4.0), (130, 3.0), (132, 2.0), (134, 3.0), (135, 4.0), (137, 4.0), (140, 3.0), (141, 4.0), (144, 3.5), (145, 5.0), (151, 5.0), (153, 2.0), (155, 3.0), (156, 4.0), (159, 4.5), (160, 4.0), (161, 4.0), (166, 5.0), (167, 3.5), (169, 4.5), (171, 5.0), (177, 5.0), (178, 4.0), (179, 4.0), (182, 4.0), (185, 
4.0), (186, 4.0), (191, 4.0), (193, 2.0), (200, 3.5), (201, 5.0), (202, 4.0), (206, 5.0), (213, 3.5), (214, 3.0), (216, 3.0), (217, 4.0), (219, 3.5), (220, 5.0), (223, 3.5), (226, 3.5), (229, 5.0), (232, 3.5), (233, 3.0), (234, 5.0), (239, 4.0), (240, 5.0), (247, 5.0), (249, 4.0), (252, 4.5), (254, 4.5), (263, 4.0), (264, 4.0), (266, 2.0), (269, 5.0), (270, 5.0), (273, 5.0), (274, 4.0), (275, 5.0), (276, 4.0), (277, 4.0), (279, 3.0), (280, 4.5), (282, 4.5), (283, 3.0), (288, 4.5), (290, 4.0), (291, 4.0), (292, 4.0), (293, 3.0), (298, 2.0), (304, 5.0), (307, 4.0), (314, 3.0), (322, 
3.5), (323, 3.5), (328, 5.0), (330, 4.0), (332, 4.0), (334, 3.5), (336, 4.0), (337, 4.0), (339, 4.0), (341, 5.0), (347, 5.0), (350, 4.0), (353, 5.0), (357, 5.0), (359, 4.0), (364, 5.0), (367, 5.0), (372, 3.0), (373, 3.0), (378, 4.5), (380, 5.0), (381, 3.5), (382, 4.5), (385, 4.0), (389, 5.0), (391, 3.0), (396, 5.0), (399, 4.0), (401, 3.5), (411, 5.0), (412, 2.0), (414, 4.0), (420, 4.0), (422, 4.0), (432, 2.5), (434, 4.0), (436, 4.0), (438, 4.5), (443, 4.0), (448, 5.0), (451, 5.0), (453, 5.0), (456, 5.0), (460, 4.5), (462, 1.5), (468, 4.0), (469, 4.0), (470, 4.0), (471, 5.0), (474, 
4.0), (476, 4.0), (477, 4.0), (480, 3.0), (483, 4.0), (484, 4.5), (488, 4.5), (490, 3.5), (492, 4.0), (500, 4.0), (504, 4.0), (509, 4.0), (514, 4.0), (517, 4.0), (522, 3.0), (524, 4.0), (525, 4.0), (528, 2.5), (529, 3.0), (533, 5.0), (534, 4.0), (541, 3.0), (544, 3.0), (550, 4.0), (555, 4.0), (559, 5.0), (560, 3.0), (561, 4.0), (562, 4.5), (567, 3.5), (570, 4.0), (572, 4.0), (573, 5.0), (579, 4.0), (580, 3.0), (584, 5.0), (587, 5.0), (590, 4.0), (596, 4.0), (597, 4.0), (599, 3.0), (600, 2.5), (601, 4.0), (603, 4.0), (604, 3.0), (605, 4.0), (606, 2.5), (607, 4.0), (608, 2.5), (609, 
3.0), (610, 5.0)]
1       2       110     [(6, 4.0), (8, 4.0), (18, 3.0), (19, 3.0), (20, 3.0), (21, 3.5), (27, 4.0), (51, 4.5), (62, 4.0), (68, 2.5), (82, 3.0), (91, 3.0), (93, 5.0), (94, 4.0), (103, 4.0), (104, 3.0), (107, 5.0), (112, 1.5), (117, 3.0), (122, 4.0), (125, 4.0), (135, 3.0), (140, 3.5), (144, 3.0), (149, 1.0), (153, 2.0), (160, 4.0), (169, 4.0), (177, 3.5), (186, 4.0), (202, 4.0), (217, 2.0), (219, 2.5), (221, 3.5), (222, 2.5), (226, 3.0), (230, 2.5), (232, 4.0), (240, 5.0), (249, 4.0), (259, 2.0), (274, 3.5), (276, 4.0), (284, 4.0), (288, 2.0), (294, 3.0), (298, 0.5), (299, 3.0), (304, 4.0), (305, 3.5), (307, 2.5), (308, 3.0), (318, 3.5), (321, 5.0), (322, 3.0), (323, 4.0), (330, 1.5), (347, 3.0), (353, 4.0), (357, 3.0), (359, 3.5), (373, 3.0), (380, 5.0), (381, 4.0), (395, 3.0), (411, 4.0), (414, 3.0), (425, 3.0), (426, 4.5), (432, 4.0), (434, 2.5), (436, 4.0), (446, 3.0), (447, 5.0), (448, 3.0), (458, 4.0), (470, 3.0), (474, 3.0), (475, 4.5), (476, 4.0), (477, 4.0), (480, 3.0), (482, 4.5), (483, 4.0), (484, 2.5), (489, 2.5), (497, 2.5), (501, 3.0), (512, 3.0), (517, 3.0), (523, 4.5), (525, 3.5), (527, 4.0), (534, 4.5), (559, 4.0), (561, 4.0), (563, 2.5), (566, 4.0), (570, 3.5), (573, 4.5), (586, 4.0), (590, 2.5), (592, 4.0), (594, 4.0), (599, 2.5), (600, 4.0), (602, 4.0), (604, 5.0), (605, 3.5), (608, 2.0)]
2       3       52      [(1, 4.0), (6, 5.0), (19, 3.0), (32, 3.0), (42, 4.0), (43, 5.0), (44, 3.0), (51, 4.0), (58, 3.0), (64, 3.5), (68, 2.0), (91, 3.0), (100, 3.5), (102, 5.0), (116, 3.5), (117, 3.0), (150, 3.0), (151, 3.0), (169, 5.0), (179, 4.0), (217, 1.0), (226, 3.5), (240, 4.0), (269, 4.0), (270, 3.0), (288, 4.0), (289, 2.5), (294, 1.0), (302, 3.0), (307, 3.5), (308, 0.5), (321, 3.0), (330, 3.0), (337, 4.0), (368, 3.0), (410, 4.0), (414, 4.0), (448, 3.0), (456, 3.0), (470, 3.0), (477, 3.0), (480, 2.5), (492, 4.0), (501, 5.0), (544, 3.0), (552, 1.0), (555, 5.0), (588, 3.0), (590, 3.0), (594, 4.0), (599, 1.5), (608, 2.0)]
3       4       7       [(6, 3.0), (14, 3.0), (84, 3.0), (162, 3.0), (262, 1.0), (411, 2.0), (600, 1.5)]
4       5       49      [(6, 5.0), (31, 3.0), (43, 5.0), (45, 3.0), (58, 4.0), (66, 4.0), (68, 2.0), (84, 3.0), (103, 4.0), (107, 4.0), (111, 3.5), (117, 3.0), (120, 4.0), (121, 3.0), (147, 4.5), 
(150, 3.0), (169, 5.0), (170, 3.0), (181, 3.0), (200, 4.0), (229, 3.0), (269, 3.0), (270, 3.0), (276, 3.0), (288, 2.0), (321, 3.0), (337, 4.0), (353, 3.0), (389, 4.0), (402, 3.0), (414, 2.0), (437, 2.0), (448, 3.0), (451, 3.0), (456, 3.0), (458, 3.0), (470, 3.0), (474, 1.5), (483, 2.5), (489, 2.0), (490, 0.5), (492, 3.0), (501, 3.0), (509, 1.5), (521, 3.0), (561, 3.0), (590, 2.0), (600, 2.5), (604, 3.0)]
5       6       102     [(1, 4.0), (6, 4.0), (11, 5.0), (18, 4.0), (23, 4.0), (24, 4.5), (28, 3.5), (32, 3.0), (44, 3.0), (45, 4.0), (57, 3.0), (62, 4.5), (64, 4.5), (68, 4.0), (79, 4.0), (82, 3.5), (84, 4.0), (91, 5.0), (102, 3.0), (105, 4.0), (109, 3.0), (112, 4.5), (117, 3.0), (121, 5.0), (140, 5.0), (150, 4.0), (160, 2.0), (166, 3.5), (181, 3.0), (182, 4.5), (191, 4.0), (195, 4.0), (199, 4.0), (202, 5.0), (217, 2.0), (219, 3.5), (220, 3.5), (239, 5.0), (244, 5.0), (266, 4.0), (269, 5.0), (270, 3.0), (274, 4.0), (282, 4.0), (286, 4.5), (294, 3.0), (297, 5.0), (305, 3.5), (308, 1.0), (312, 4.0), (313, 3.0), (314, 3.0), (317, 5.0), (318, 4.0), (325, 4.0), (336, 4.0), (337, 5.0), (339, 4.0), (353, 4.0), (362, 4.0), (368, 4.0), (372, 5.0), (373, 5.0), (380, 5.0), (385, 3.0), (386, 3.0), (389, 5.0), (391, 4.0), (400, 5.0), (414, 3.0), (425, 4.0), (434, 4.0), (437, 5.0), (438, 5.0), (444, 4.0), (451, 4.0), (469, 3.0), (470, 3.0), (474, 3.0), (480, 4.0), (486, 5.0), (492, 3.0), (493, 4.0), (501, 3.0), (521, 4.0), (524, 4.0), (532, 5.0), (553, 5.0), (559, 5.0), (561, 4.0), (573, 4.5), (577, 4.0), (580, 4.0), (588, 5.0), (590, 3.5), (592, 3.0), (597, 3.0), (599, 4.5), (602, 3.0), (603, 4.0), (604, 3.0), (610, 5.0)]
6       7       54      [(6, 4.0), (14, 3.0), (19, 2.0), (31, 4.0), (32, 4.0), (33, 1.0), (42, 3.0), (43, 5.0), (45, 3.0), (51, 4.0), (58, 5.0), (68, 2.0), (71, 3.0), (84, 3.0), (90, 4.0), (95, 3.0), (117, 4.0), (150, 3.0), (169, 4.5), (177, 1.0), (179, 3.0), (181, 3.0), (188, 4.0), (199, 3.0), (206, 4.0), (257, 1.0), (262, 3.0), (270, 3.0), (276, 4.0), (280, 4.5), (286, 3.5), (304, 4.0), 
(314, 4.0), (337, 3.0), (350, 3.0), (411, 3.0), (414, 3.0), (451, 3.0), (470, 3.0), (474, 3.0), (489, 4.0), (492, 3.0), (498, 4.0), (501, 4.0), (510, 1.0), (513, 3.0), (521, 3.0), (529, 2.0), (541, 4.0), (566, 4.0), (597, 1.0), (599, 2.5), (600, 3.5), (606, 2.5)]
7       8       8       [(6, 3.0), (20, 1.0), (43, 5.0), (274, 3.0), (372, 2.0), (414, 3.0), (436, 3.0), (501, 3.0)]
8       9       16      [(151, 4.0), (179, 3.0), (217, 3.0), (269, 2.0), (270, 3.0), (337, 5.0), (353, 3.0), (364, 3.0), (389, 3.0), (402, 3.0), (428, 2.0), (437, 3.0), (456, 4.0), (464, 2.5), (492, 5.0), (599, 1.5)]
9       10      132     [(6, 3.0), (8, 2.0), (11, 3.0), (19, 2.0), (21, 5.0), (26, 3.0), (31, 4.0), (34, 5.0), (42, 5.0), (43, 4.0), (46, 3.0), (56, 4.0), (57, 3.0), (59, 3.0), (63, 3.0), (68, 4.5), (81, 1.0), (82, 3.5), (84, 3.0), (91, 3.5), (93, 4.0), (94, 3.0), (99, 4.0), (104, 3.0), (117, 3.0), (119, 4.0), (136, 5.0), (144, 3.0), (160, 1.0), (166, 4.5), (170, 3.0), (173, 3.0), (174, 3.0), (176, 5.0), (178, 4.0), (181, 2.0), (182, 3.5), (186, 4.0), (192, 5.0), (195, 4.0), (200, 4.5), (202, 4.0), (208, 2.0), (217, 4.0), (219, 4.5), (220, 4.0), (226, 4.0), (229, 4.0), (232, 3.0), 
(235, 2.0), (240, 3.0), (243, 5.0), (244, 5.0), (248, 3.5), (262, 2.0), (274, 4.0), (282, 3.5), (284, 4.0), (288, 3.0), (292, 3.5), (294, 3.0), (301, 4.0), (304, 4.0), (307, 2.5), (313, 4.0), (314, 3.0), (322, 4.0), (331, 3.0), (334, 3.5), (340, 4.0), (347, 4.0), (349, 4.0), (353, 3.0), (354, 3.5), (361, 3.5), (368, 3.0), (372, 3.0), (376, 4.5), (380, 5.0), (385, 3.0), (386, 3.0), (387, 3.5), (391, 3.0), (395, 3.0), (408, 4.5), (411, 3.0), (414, 3.0), (419, 3.5), (425, 3.0), (434, 3.5), (438, 4.0), (441, 4.5), (446, 3.0), (447, 3.0), (448, 4.0), (452, 4.0), (453, 2.0), (458, 4.0), 
(462, 3.0), (469, 2.0), (470, 3.0), (476, 3.0), (480, 4.0), (483, 2.0), (485, 4.0), (486, 4.0), (489, 2.5), (498, 3.0), (501, 4.0), (517, 0.5), (520, 4.0), (522, 4.5), (524, 4.0), (531, 4.0), (534, 4.0), (541, 4.0), (557, 4.5), (559, 3.0), (566, 3.0), (569, 4.0), (570, 3.5), (573, 4.5), (580, 3.5), (584, 5.0), (588, 3.0), (590, 3.5), (592, 3.0), (597, 3.0), (599, 3.5), (602, 3.0), (608, 4.0), (609, 4.0)]


ratings_dict: 9724

통계 요약
max rating num: 329
min rating num: 1
average rating num: 10.370


'''
